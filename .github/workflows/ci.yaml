name: CI (IntegraÃ§Ã£o ContÃ­nua)

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¦ Checkout repository
      # VersÃ£o v4 Ã© a mais estÃ¡vel e recente
      uses: actions/checkout@v4 

    - name: ğŸ Set up Python 3.12
      # Usando a versÃ£o mais recente da action (v5)
      uses: actions/setup-python@v5
      with:
        python-version: '3.12'

    - name: âš™ï¸ Install all dependencies (including linters and tests)
      # Instala todas as dependÃªncias do requirements.txt em um sÃ³ passo
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    # ----------------------------------------------------
    # Passo 1: LINTING (VerificaÃ§Ã£o de Estilo/Qualidade)
    # ----------------------------------------------------
    - name: ğŸ§¹ Lint with flake8
      run: |
        # flake8 jÃ¡ deve estar instalado via requirements.txt
        flake8 src tests

    # ----------------------------------------------------
    # Passo 2: TESTES UNITÃRIOS E DE INTEGRAÃ‡ÃƒO
    # ----------------------------------------------------
    - name: âœ… Run PyTest
      # -q para saÃ­da mais concisa
      run: |
        pytest -q
